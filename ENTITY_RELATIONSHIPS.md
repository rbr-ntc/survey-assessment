# üîó ENTITY_RELATIONSHIPS ‚Äî Hybrid (MongoDB content + Postgres management)

## –ì–ª–∞–≤–Ω—ã–π –æ—Ç–≤–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å ‚Äú–∫–∞–∫—É—é –º–æ–¥–µ–ª—å –≤—ã–±—Ä–∞–ª–∏?‚Äù

**–í—ã–±—Ä–∞–Ω–∞ –≥–∏–±—Ä–∏–¥–Ω–∞—è –º–æ–¥–µ–ª—å:**

- **MongoDB**: –∫–æ–Ω—Ç–µ–Ω—Ç (Course/Module/Lesson), –≤–æ–ø—Ä–æ—Å—ã/–∫–≤–∏–∑—ã/–ø—Ä–∞–∫—Ç–∏–∫–∏ (–≥–∏–±–∫–∏–µ JSON —Å—Ç—Ä—É–∫—Ç—É—Ä—ã)
- **PostgreSQL**: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –¥–æ—Å—Ç—É–ø—ã, –ø—Ä–æ–≥—Ä–µ—Å—Å, –ø–æ–ø—ã—Ç–∫–∏, –ø–ª–∞—Ç–µ–∂–∏, –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

---

## –î–∏–∞–≥—Ä–∞–º–º–∞ –Ω–∞ —É—Ä–æ–≤–Ω–µ –¥–æ–º–µ–Ω–∞ (—É–ø—Ä–æ—â–µ–Ω–Ω–æ)

```
Postgres                                  Mongo
--------                                  ----
users (uuid)                               course_content (string id)
  |                                        lesson_content (string id)
  | 1..N                                   quiz_content (string id)
  v                                        questions (existing)
quiz_attempts (uuid)  ----(details_ref)->  quiz_attempt_details (optional)
  |
  | N..1
  v
courses (uuid) ----(content_id)---------> course_content._id
  |
  | 1..N
  v
enrollments (uuid)
  |
  | 1..N
  v
lesson_progress (uuid) --(lesson_content_id)-> lesson_content._id

payments/subscriptions (uuid) ‚Äî —Ç–æ–ª—å–∫–æ Postgres
achievements (uuid) ‚Äî Postgres (+ rule/context jsonb)
```

---

## –ü–æ—á–µ–º—É —Ç–∞–∫ –ª—É—á—à–µ –∏–º–µ–Ω–Ω–æ —Å–µ–π—á–∞—Å

- **–ù–µ –ª–æ–º–∞–µ–º —Ç–µ–∫—É—â–∏–π —Ç–µ—Å—Ç** (–≤–æ–ø—Ä–æ—Å—ã –∏ –ø–æ–¥—Å—á–µ—Ç –æ—Å—Ç–∞—é—Ç—Å—è –≤ Mongo + —Ç–µ–∫—É—â–∏–µ —Ä–æ—É—Ç—ã –º–æ–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å).
- **Postgres –Ω—É–∂–µ–Ω —Ç–∞–º, –≥–¥–µ ‚Äú–¥–µ–Ω—å–≥–∏/–ø—Ä–∞–≤–∞/–∞–Ω–∞–ª–∏—Ç–∏–∫–∞/—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å‚Äù**.
- **Mongo —É–¥–æ–±–µ–Ω –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞**, –ø–æ—Ç–æ–º—É —á—Ç–æ:
  - —É—Ä–æ–∫–∏ –∏ –ø—Ä–∞–∫—Ç–∏–∫–∏ –±—É–¥—É—Ç –º–µ–Ω—è—Ç—å—Å—è
  - —Ç–∏–ø—ã –≤–æ–ø—Ä–æ—Å–æ–≤/–∫–æ–Ω—Ñ–∏–≥–∏ —Ä–µ–¥–∞–∫—Ç–æ—Ä–æ–≤ ‚Äî –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π JSON
  - –º–µ–Ω—å—à–µ –º–∏–≥—Ä–∞—Ü–∏–π –Ω–∞ —Å—Ç–∞—Ä—Ç–µ

---

## –ü—Ä–∞–≤–∏–ª–æ ID –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

- **User ID**: UUIDv7 (Postgres)
- **Content IDs**: —Å—Ç—Ä–æ–∫–æ–≤—ã–µ —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ –∫–ª—é—á–∏ –≤ Mongo:
  - `course:rest-api-design`
  - `lesson:rest-intro`
  - `quiz:rest-basics`
- Postgres —Ö—Ä–∞–Ω–∏—Ç —Å—Å—ã–ª–∫–∏ –Ω–∞ content —á–µ—Ä–µ–∑ `content_id` / `lesson_content_id` / `quiz_content_id`.

---

## MVP: –∫–∞–∫–∏–µ —Å—É—â–Ω–æ—Å—Ç–∏ –¥–µ–ª–∞–µ–º –ø–µ—Ä–≤—ã–º–∏

### 1) Postgres (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)

- `users`
- `auth_refresh_tokens` (–∏–ª–∏ `sessions`)
- `quiz_attempts` (summary —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞, —Å–≤—è–∑—å —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º)

### 2) Mongo (–∫–∞–∫ –µ—Å—Ç—å + –º–∏–Ω–∏–º–∞–ª—å–Ω–æ)

- `questions` (—É–∂–µ –µ—Å—Ç—å)
- (–ø–æ–∑–∂–µ) `course_content`, `lesson_content`, `quiz_content`

---

## –ö–∞–∫ ‚Äú–≤—Å—Ç—Ä–æ–∏—Ç—å —Ç–µ–∫—É—â–∏–π —Ç–µ—Å—Ç‚Äù –≤ LearnHub –±–µ–∑ –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–Ω–∏—è

1. –û—Å—Ç–∞–≤–ª—è–µ–º —Ç–µ–∫—É—â–∏–π —ç–Ω–¥–ø–æ–∏–Ω—Ç –≤–æ–ø—Ä–æ—Å–æ–≤ (–∏–ª–∏ –¥–µ–ª–∞–µ–º –∞–ª–∏–∞—Å):
   - —Å–µ–π—á–∞—Å: `GET /questions` (Mongo)
   - —Å—Ç–∞–Ω–µ—Ç: `GET /api/v1/quizzes/{quizId}` (–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤–æ–ø—Ä–æ—Å—ã)
2. –ü—Ä–∏ —Å–∞–±–º–∏—Ç–µ:
   - –¥–µ—Ç–∞–ª–∏ (answers, question_details) –º–æ–∂–Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å —Ö—Ä–∞–Ω–∏—Ç—å –≤ Mongo (–∫–∞–∫ —Å–µ–π—á–∞—Å)
   - summary (score, passed, timestamps) –ø–∏—à–µ–º –≤ Postgres `quiz_attempts`
3. UI:
   - –ø–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —Ç–µ—Å—Ç ‚Äú–ø—Ä–∏–∫—Ä–µ–ø–ª—è–µ–º‚Äù –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
   - –ø–æ—è–≤–ª—è–µ—Ç—Å—è ‚Äú–∏—Å—Ç–æ—Ä–∏—è –ø–æ–ø—ã—Ç–æ–∫‚Äù –∏–∑ Postgres
